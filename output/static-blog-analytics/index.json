{
  "schema_name": "DoclingDocument",
  "version": "1.4.0",
  "name": "index",
  "origin": {
    "mimetype": "text/markdown",
    "binary_hash": 1745846365161164692,
    "filename": "index.md"
  },
  "furniture": {
    "self_ref": "#/furniture",
    "children": [],
    "content_layer": "furniture",
    "name": "_root_",
    "label": "unspecified"
  },
  "body": {
    "self_ref": "#/body",
    "children": [
      {
        "$ref": "#/texts/0"
      },
      {
        "$ref": "#/groups/0"
      },
      {
        "$ref": "#/texts/7"
      },
      {
        "$ref": "#/texts/8"
      },
      {
        "$ref": "#/texts/9"
      },
      {
        "$ref": "#/texts/10"
      },
      {
        "$ref": "#/texts/11"
      },
      {
        "$ref": "#/texts/12"
      },
      {
        "$ref": "#/texts/13"
      },
      {
        "$ref": "#/texts/14"
      },
      {
        "$ref": "#/texts/15"
      },
      {
        "$ref": "#/groups/1"
      },
      {
        "$ref": "#/texts/20"
      },
      {
        "$ref": "#/texts/21"
      },
      {
        "$ref": "#/groups/2"
      },
      {
        "$ref": "#/texts/25"
      },
      {
        "$ref": "#/texts/26"
      },
      {
        "$ref": "#/texts/27"
      },
      {
        "$ref": "#/texts/28"
      },
      {
        "$ref": "#/texts/29"
      },
      {
        "$ref": "#/texts/30"
      },
      {
        "$ref": "#/texts/31"
      },
      {
        "$ref": "#/texts/32"
      },
      {
        "$ref": "#/texts/33"
      },
      {
        "$ref": "#/texts/34"
      },
      {
        "$ref": "#/texts/35"
      },
      {
        "$ref": "#/texts/36"
      },
      {
        "$ref": "#/texts/37"
      },
      {
        "$ref": "#/texts/38"
      },
      {
        "$ref": "#/texts/39"
      },
      {
        "$ref": "#/texts/40"
      },
      {
        "$ref": "#/texts/41"
      },
      {
        "$ref": "#/texts/42"
      },
      {
        "$ref": "#/texts/43"
      },
      {
        "$ref": "#/texts/44"
      },
      {
        "$ref": "#/texts/45"
      },
      {
        "$ref": "#/texts/46"
      },
      {
        "$ref": "#/texts/47"
      },
      {
        "$ref": "#/texts/48"
      },
      {
        "$ref": "#/texts/49"
      },
      {
        "$ref": "#/texts/50"
      },
      {
        "$ref": "#/texts/51"
      },
      {
        "$ref": "#/texts/52"
      },
      {
        "$ref": "#/texts/53"
      },
      {
        "$ref": "#/texts/54"
      },
      {
        "$ref": "#/texts/55"
      },
      {
        "$ref": "#/texts/56"
      },
      {
        "$ref": "#/texts/57"
      },
      {
        "$ref": "#/texts/58"
      },
      {
        "$ref": "#/texts/59"
      },
      {
        "$ref": "#/texts/60"
      },
      {
        "$ref": "#/texts/61"
      },
      {
        "$ref": "#/texts/62"
      },
      {
        "$ref": "#/texts/63"
      },
      {
        "$ref": "#/texts/64"
      },
      {
        "$ref": "#/texts/65"
      },
      {
        "$ref": "#/texts/66"
      },
      {
        "$ref": "#/texts/67"
      },
      {
        "$ref": "#/texts/68"
      },
      {
        "$ref": "#/texts/69"
      },
      {
        "$ref": "#/texts/70"
      },
      {
        "$ref": "#/texts/71"
      },
      {
        "$ref": "#/texts/72"
      },
      {
        "$ref": "#/texts/73"
      },
      {
        "$ref": "#/texts/74"
      },
      {
        "$ref": "#/texts/75"
      },
      {
        "$ref": "#/texts/76"
      },
      {
        "$ref": "#/texts/77"
      },
      {
        "$ref": "#/texts/78"
      },
      {
        "$ref": "#/texts/79"
      },
      {
        "$ref": "#/texts/80"
      },
      {
        "$ref": "#/texts/81"
      },
      {
        "$ref": "#/texts/82"
      },
      {
        "$ref": "#/texts/83"
      },
      {
        "$ref": "#/texts/84"
      },
      {
        "$ref": "#/texts/85"
      },
      {
        "$ref": "#/texts/86"
      },
      {
        "$ref": "#/texts/87"
      },
      {
        "$ref": "#/texts/88"
      },
      {
        "$ref": "#/texts/89"
      }
    ],
    "content_layer": "body",
    "name": "_root_",
    "label": "unspecified"
  },
  "groups": [
    {
      "self_ref": "#/groups/0",
      "parent": {
        "$ref": "#/body"
      },
      "children": [
        {
          "$ref": "#/texts/1"
        },
        {
          "$ref": "#/texts/2"
        },
        {
          "$ref": "#/texts/3"
        },
        {
          "$ref": "#/texts/4"
        },
        {
          "$ref": "#/texts/5"
        },
        {
          "$ref": "#/texts/6"
        }
      ],
      "content_layer": "body",
      "name": "list",
      "label": "list"
    },
    {
      "self_ref": "#/groups/1",
      "parent": {
        "$ref": "#/body"
      },
      "children": [
        {
          "$ref": "#/texts/16"
        },
        {
          "$ref": "#/texts/17"
        },
        {
          "$ref": "#/texts/18"
        },
        {
          "$ref": "#/texts/19"
        }
      ],
      "content_layer": "body",
      "name": "list",
      "label": "list"
    },
    {
      "self_ref": "#/groups/2",
      "parent": {
        "$ref": "#/body"
      },
      "children": [
        {
          "$ref": "#/texts/22"
        },
        {
          "$ref": "#/texts/23"
        },
        {
          "$ref": "#/texts/24"
        }
      ],
      "content_layer": "body",
      "name": "list",
      "label": "ordered_list"
    }
  ],
  "texts": [
    {
      "self_ref": "#/texts/0",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "author: Major Hayden date: '2024-04-04' Static blogs are easy to serve, but so many of the free options have no analytics whatsoever. This post talks about how to serve your own blog from a container with live updating analytics tags: ",
      "text": "author: Major Hayden date: '2024-04-04' Static blogs are easy to serve, but so many of the free options have no analytics whatsoever. This post talks about how to serve your own blog from a container with live updating analytics tags: "
    },
    {
      "self_ref": "#/texts/1",
      "parent": {
        "$ref": "#/groups/0"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "amd",
      "text": "amd",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/2",
      "parent": {
        "$ref": "#/groups/0"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "fedora",
      "text": "fedora",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/3",
      "parent": {
        "$ref": "#/groups/0"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "laptop",
      "text": "laptop",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/4",
      "parent": {
        "$ref": "#/groups/0"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "linux",
      "text": "linux",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/5",
      "parent": {
        "$ref": "#/groups/0"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "sway",
      "text": "sway",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/6",
      "parent": {
        "$ref": "#/groups/0"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "thinkpad",
      "text": "thinkpad",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/7",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Static blogs come with tons of advantages. They're cheap to serve. You store all your changes in git. People with spotty internet connections can clone your blog and run it locally.",
      "text": "Static blogs come with tons of advantages. They're cheap to serve. You store all your changes in git. People with spotty internet connections can clone your blog and run it locally."
    },
    {
      "self_ref": "#/texts/8",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "However, one of the challenges that I've run into over the years is around analytics.",
      "text": "However, one of the challenges that I've run into over the years is around analytics."
    },
    {
      "self_ref": "#/texts/9",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "I could quickly add Google Analytics to the site and call it a day, but is that a good idea? Many browsers have ad blocking these days and the analytics wouldn't even run. For those that don't have an ad blocker, do I want to send more data about them to Google? \ud83d\ude43",
      "text": "I could quickly add Google Analytics to the site and call it a day, but is that a good idea? Many browsers have ad blocking these days and the analytics wouldn't even run. For those that don't have an ad blocker, do I want to send more data about them to Google? \ud83d\ude43"
    },
    {
      "self_ref": "#/texts/10",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "How about running my own self-hosted analytics platform? That's pretty easy with containers, but most ad blockers know about those, too.",
      "text": "How about running my own self-hosted analytics platform? That's pretty easy with containers, but most ad blockers know about those, too."
    },
    {
      "self_ref": "#/texts/11",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "This post talks about how to host a static blog in a container behind a  Caddy  web server. We will use  goaccess  to analyze the log files on the server itself to avoid dragging in an analytics platform.",
      "text": "This post talks about how to host a static blog in a container behind a  Caddy  web server. We will use  goaccess  to analyze the log files on the server itself to avoid dragging in an analytics platform."
    },
    {
      "self_ref": "#/texts/12",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "Why do you need analytics?",
      "text": "Why do you need analytics?",
      "level": 1
    },
    {
      "self_ref": "#/texts/13",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Yes, yes, I know this comes from the guy who wrote a post about  writing for yourself , but sometimes I like to know which posts are popular with other people. I also like to know if something's misconfigured and visitors are seeing 404 errors for pages which should be working.",
      "text": "Yes, yes, I know this comes from the guy who wrote a post about  writing for yourself , but sometimes I like to know which posts are popular with other people. I also like to know if something's misconfigured and visitors are seeing 404 errors for pages which should be working."
    },
    {
      "self_ref": "#/texts/14",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "It can also be handy to know when someone else is  writing about you , especially when those things are incorrect. \ud83d\ude09",
      "text": "It can also be handy to know when someone else is  writing about you , especially when those things are incorrect. \ud83d\ude09"
    },
    {
      "self_ref": "#/texts/15",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "So my goals here are these:",
      "text": "So my goals here are these:"
    },
    {
      "self_ref": "#/texts/16",
      "parent": {
        "$ref": "#/groups/1"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "Get some basic data on what's resonating with people and what isn't",
      "text": "Get some basic data on what's resonating with people and what isn't",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/17",
      "parent": {
        "$ref": "#/groups/1"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "Find configuration errors that are leading visitors to error pages",
      "text": "Find configuration errors that are leading visitors to error pages",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/18",
      "parent": {
        "$ref": "#/groups/1"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "Learn more about who is linking to the site",
      "text": "Learn more about who is linking to the site",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/19",
      "parent": {
        "$ref": "#/groups/1"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "Do all this without impacting user privacy through heavy javascript trackers",
      "text": "Do all this without impacting user privacy through heavy javascript trackers",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/20",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "What are the ingredients?",
      "text": "What are the ingredients?",
      "level": 1
    },
    {
      "self_ref": "#/texts/21",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "There are three main pieces:",
      "text": "There are three main pieces:"
    },
    {
      "self_ref": "#/texts/22",
      "parent": {
        "$ref": "#/groups/2"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "Caddy, a small web server that runs really well in containers",
      "text": "Caddy, a small web server that runs really well in containers",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/23",
      "parent": {
        "$ref": "#/groups/2"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "This blog, which is written with ",
      "text": "This blog, which is written with ",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/24",
      "parent": {
        "$ref": "#/groups/2"
      },
      "children": [],
      "content_layer": "body",
      "label": "list_item",
      "prov": [],
      "orig": "Goaccess, a log analyzer with a capability to do live updates via websockets",
      "text": "Goaccess, a log analyzer with a capability to do live updates via websockets",
      "enumerated": false,
      "marker": "-"
    },
    {
      "self_ref": "#/texts/25",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Caddy will write logs to a location that goaccess can read. In turn, goaccess will write log analysis to an HTML file that caddy can serve. The HTML file served by caddy will open a websocket to goaccess for live analytics.",
      "text": "Caddy will write logs to a location that goaccess can read. In turn, goaccess will write log analysis to an HTML file that caddy can serve. The HTML file served by caddy will open a websocket to goaccess for live analytics."
    },
    {
      "self_ref": "#/texts/26",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "A static blog in a container?",
      "text": "A static blog in a container?",
      "level": 1
    },
    {
      "self_ref": "#/texts/27",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "We can pack a static blog into a very thin container with an extremely lightweight web server. After all, caddy can handle automatic TLS certificate installation, logging, and caching. That just means we need the most basic webserver in the container itself.",
      "text": "We can pack a static blog into a very thin container with an extremely lightweight web server. After all, caddy can handle automatic TLS certificate installation, logging, and caching. That just means we need the most basic webserver in the container itself."
    },
    {
      "self_ref": "#/texts/28",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "I was considering a second caddy container with the blog content in it until I stumbled upon a great post by Florin Lipan about  The smallest Docker image to serve static websites . He went down a rabbit hole to make the smallest possible web server container with busybox.",
      "text": "I was considering a second caddy container with the blog content in it until I stumbled upon a great post by Florin Lipan about  The smallest Docker image to serve static websites . He went down a rabbit hole to make the smallest possible web server container with busybox."
    },
    {
      "self_ref": "#/texts/29",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "His first stop led to a 1.25MB container, and that's tiny enough for me.[^keptgoing] \ud83e\udd0f",
      "text": "His first stop led to a 1.25MB container, and that's tiny enough for me.[^keptgoing] \ud83e\udd0f"
    },
    {
      "self_ref": "#/texts/30",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "[^keptgoing]: Florin went all the way down to 154KB and I was extremely impressed. However, I'm not too worried about an extra megabyte here. \ud83d\ude09",
      "text": "[^keptgoing]: Florin went all the way down to 154KB and I was extremely impressed. However, I'm not too worried about an extra megabyte here. \ud83d\ude09"
    },
    {
      "self_ref": "#/texts/31",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "I built a  container workflow  in GitHub Actions that builds a container, puts the blog in it, and  stores that container as a package  in the GitHub repository. It all starts with a brief Dockerfile:",
      "text": "I built a  container workflow  in GitHub Actions that builds a container, puts the blog in it, and  stores that container as a package  in the GitHub repository. It all starts with a brief Dockerfile:"
    },
    {
      "self_ref": "#/texts/32",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "FROM docker.io/library/busybox:1.36.1\nRUN adduser -D static\nUSER static\nWORKDIR /home/static\nCOPY ./public/ /home/static\nCMD [\"busybox\", \"httpd\", \"-f\", \"-p\", \"3000\"]",
      "text": "FROM docker.io/library/busybox:1.36.1\nRUN adduser -D static\nUSER static\nWORKDIR /home/static\nCOPY ./public/ /home/static\nCMD [\"busybox\", \"httpd\", \"-f\", \"-p\", \"3000\"]",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/33",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "We start with busybox, add a user, put the website content into the user's home directory, and start busybox's ",
      "text": "We start with busybox, add a user, put the website content into the user's home directory, and start busybox's "
    },
    {
      "self_ref": "#/texts/34",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "httpd",
      "text": "httpd",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/35",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " server. The container starts up and serves the static content on port 3000.",
      "text": " server. The container starts up and serves the static content on port 3000."
    },
    {
      "self_ref": "#/texts/36",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "Caddy logs",
      "text": "Caddy logs",
      "level": 1
    },
    {
      "self_ref": "#/texts/37",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Caddy writes its logs in a JSON format and goaccess already knows how to parse caddy logs. Our first step is to get caddy writing some logs. In my case, I have a directory called ",
      "text": "Caddy writes its logs in a JSON format and goaccess already knows how to parse caddy logs. Our first step is to get caddy writing some logs. In my case, I have a directory called "
    },
    {
      "self_ref": "#/texts/38",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "caddy/logs/",
      "text": "caddy/logs/",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/39",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " in my home directory where those logs are written.",
      "text": " in my home directory where those logs are written."
    },
    {
      "self_ref": "#/texts/40",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "I'll mount the log storage into the caddy container and mount one extra directory to hold the HTML file that goaccess will write. Here's my ",
      "text": "I'll mount the log storage into the caddy container and mount one extra directory to hold the HTML file that goaccess will write. Here's my "
    },
    {
      "self_ref": "#/texts/41",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "docker-compose.yaml",
      "text": "docker-compose.yaml",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/42",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " excerpt:",
      "text": " excerpt:"
    },
    {
      "self_ref": "#/texts/43",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "caddy:\n    image: ghcr.io/major/caddy:main\n    container_name: caddy\n    ports:\n      - \"80:80/tcp\"\n      - \"443:443/tcp\"\n      - \"443:443/udp\"\n    restart: unless-stopped\n    volumes:\n      - ./caddy/Caddyfile:/etc/caddy/Caddyfile:Z\n      - caddy_data:/data\n      - caddy_config:/config\n      # Caddy writes logs here \ud83d\udc47\n      - ./caddy/logs:/logs:z\n      # This is for goaccess to write its HTML file \ud83d\udc47\n      - ./storage/goaccess_major_io:/var/www/goaccess_major_io:z",
      "text": "caddy:\n    image: ghcr.io/major/caddy:main\n    container_name: caddy\n    ports:\n      - \"80:80/tcp\"\n      - \"443:443/tcp\"\n      - \"443:443/udp\"\n    restart: unless-stopped\n    volumes:\n      - ./caddy/Caddyfile:/etc/caddy/Caddyfile:Z\n      - caddy_data:/data\n      - caddy_config:/config\n      # Caddy writes logs here \ud83d\udc47\n      - ./caddy/logs:/logs:z\n      # This is for goaccess to write its HTML file \ud83d\udc47\n      - ./storage/goaccess_major_io:/var/www/goaccess_major_io:z",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/44",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Now we need to update the ",
      "text": "Now we need to update the "
    },
    {
      "self_ref": "#/texts/45",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "Caddyfile",
      "text": "Caddyfile",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/46",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " to tell caddy where to place the logs and add a ",
      "text": " to tell caddy where to place the logs and add a "
    },
    {
      "self_ref": "#/texts/47",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "reverse_proxy",
      "text": "reverse_proxy",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/48",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " configuration for our new container that serves the blog:",
      "text": " configuration for our new container that serves the blog:"
    },
    {
      "self_ref": "#/texts/49",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "major.io {\n    # We will set up this container in a moment \ud83d\udc47\n    reverse_proxy major_io:3000 {\n        lb_try_duration 30s\n    }\n\n    # Tell Caddy to write logs to `/logs` which\n    # is `storage/logs` on the host:\n    log {\n        output file /logs/major.io-access.log {\n            roll_size 1024mb\n            roll_keep 20\n            roll_keep_for 720h\n        }\n    }\n}",
      "text": "major.io {\n    # We will set up this container in a moment \ud83d\udc47\n    reverse_proxy major_io:3000 {\n        lb_try_duration 30s\n    }\n\n    # Tell Caddy to write logs to `/logs` which\n    # is `storage/logs` on the host:\n    log {\n        output file /logs/major.io-access.log {\n            roll_size 1024mb\n            roll_keep 20\n            roll_keep_for 720h\n        }\n    }\n}",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/50",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Great! We now have the configuration in place for caddy to write the logs and the caddy container can mount the log and analytics storage.",
      "text": "Great! We now have the configuration in place for caddy to write the logs and the caddy container can mount the log and analytics storage."
    },
    {
      "self_ref": "#/texts/51",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "Enabling analytics",
      "text": "Enabling analytics",
      "level": 1
    },
    {
      "self_ref": "#/texts/52",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "We're heading back to the ",
      "text": "We're heading back to the "
    },
    {
      "self_ref": "#/texts/53",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "docker-compose.yml",
      "text": "docker-compose.yml",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/54",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " file once more, this time to set up a goaccess container:",
      "text": " file once more, this time to set up a goaccess container:"
    },
    {
      "self_ref": "#/texts/55",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "goaccess_major_io:\n    image: docker.io/allinurl/goaccess:latest\n    container_name: goaccess_major_io\n    restart: always\n    volumes:\n      # Mount caddy's log files \ud83d\udc47\n      - \"./caddy/logs:/var/log/caddy:z\"\n      # Mount the directory where goaccess writes the analytics HTML \ud83d\udc47\n      - \"./storage/goaccess_major_io:/var/www/goaccess:rw\"\n    command: \"/var/log/caddy/major.io-access.log --log-format=CADDY -o /var/www/goaccess/index.html --real-time-html --ws-url=wss://stats.major.io:443/ws --port=7890 --anonymize-ip --ignore-crawlers --real-os\"",
      "text": "goaccess_major_io:\n    image: docker.io/allinurl/goaccess:latest\n    container_name: goaccess_major_io\n    restart: always\n    volumes:\n      # Mount caddy's log files \ud83d\udc47\n      - \"./caddy/logs:/var/log/caddy:z\"\n      # Mount the directory where goaccess writes the analytics HTML \ud83d\udc47\n      - \"./storage/goaccess_major_io:/var/www/goaccess:rw\"\n    command: \"/var/log/caddy/major.io-access.log --log-format=CADDY -o /var/www/goaccess/index.html --real-time-html --ws-url=wss://stats.major.io:443/ws --port=7890 --anonymize-ip --ignore-crawlers --real-os\"",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/56",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "This gets us a goaccess container to parse the logs from caddy. We need to update the caddy configuration so that we can reach the goaccess websocket for live updates:",
      "text": "This gets us a goaccess container to parse the logs from caddy. We need to update the caddy configuration so that we can reach the goaccess websocket for live updates:"
    },
    {
      "self_ref": "#/texts/57",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "stats.major.io {\n    root * /var/www/goaccess_major_io\n    file_server\n    reverse_proxy /ws goaccess_major_io:7890\n}",
      "text": "stats.major.io {\n    root * /var/www/goaccess_major_io\n    file_server\n    reverse_proxy /ws goaccess_major_io:7890\n}",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/58",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "At this point, we have caddy writing logs in the right place, goaccess can read them, and the analytics output is written to a place where caddy can serve it. We've also exposed the websocket from goaccess for live updates.",
      "text": "At this point, we have caddy writing logs in the right place, goaccess can read them, and the analytics output is written to a place where caddy can serve it. We've also exposed the websocket from goaccess for live updates."
    },
    {
      "self_ref": "#/texts/59",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "Serving the blog",
      "text": "Serving the blog",
      "level": 1
    },
    {
      "self_ref": "#/texts/60",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "We've reached the most important part!",
      "text": "We've reached the most important part!"
    },
    {
      "self_ref": "#/texts/61",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "We added the caddy configuration to reach the blog container earlier, but now it's time to deploy the container itself. As a reminder, this is the container with busybox and the blog content that comes from GitHub Actions.",
      "text": "We added the caddy configuration to reach the blog container earlier, but now it's time to deploy the container itself. As a reminder, this is the container with busybox and the blog content that comes from GitHub Actions."
    },
    {
      "self_ref": "#/texts/62",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "The ",
      "text": "The "
    },
    {
      "self_ref": "#/texts/63",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "docker-compose.yml",
      "text": "docker-compose.yml",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/64",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " configuration here is  very basic :",
      "text": " configuration here is  very basic :"
    },
    {
      "self_ref": "#/texts/65",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "major_io:\n    image: ghcr.io/major/major.io:main\n    container_name: major_io\n    restart: always",
      "text": "major_io:\n    image: ghcr.io/major/major.io:main\n    container_name: major_io\n    restart: always",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/66",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "Caddy will connect to this container on port 3000 to serve the blog. (We set port 3000 in the original ",
      "text": "Caddy will connect to this container on port 3000 to serve the blog. (We set port 3000 in the original "
    },
    {
      "self_ref": "#/texts/67",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "Dockerfile",
      "text": "Dockerfile",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/68",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": ").",
      "text": ")."
    },
    {
      "self_ref": "#/texts/69",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "At this point, everything should be set to go. Make it live with:",
      "text": "At this point, everything should be set to go. Make it live with:"
    },
    {
      "self_ref": "#/texts/70",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "docker-compose up -d",
      "text": "docker-compose up -d",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/71",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "This should bring up the goaccess and blog containers while also restarting caddy. The website should be visible now at  major.io  (and that's how you're reading this today).",
      "text": "This should bring up the goaccess and blog containers while also restarting caddy. The website should be visible now at  major.io  (and that's how you're reading this today)."
    },
    {
      "self_ref": "#/texts/72",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "section_header",
      "prov": [],
      "orig": "What about new posts?",
      "text": "What about new posts?",
      "level": 1
    },
    {
      "self_ref": "#/texts/73",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "I'm glad you asked! That was something I wondered about as well. How do we get the new blog content down to the container when a new post is written?  \ud83e\udd14",
      "text": "I'm glad you asked! That was something I wondered about as well. How do we get the new blog content down to the container when a new post is written?  \ud83e\udd14"
    },
    {
      "self_ref": "#/texts/74",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "As I've  written in the past , I like using  watchtower  to keep containers updated. Watchtower offers an HTTP API interface for webhooks to initiate container updates. We can trigger that update via a simple curl request from GitHub Actions when our container pipeline runs.",
      "text": "As I've  written in the past , I like using  watchtower  to keep containers updated. Watchtower offers an HTTP API interface for webhooks to initiate container updates. We can trigger that update via a simple curl request from GitHub Actions when our container pipeline runs."
    },
    {
      "self_ref": "#/texts/75",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "My  container workflow  has a brief bit at the end that does this:",
      "text": "My  container workflow  has a brief bit at the end that does this:"
    },
    {
      "self_ref": "#/texts/76",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "- name: Update the blog container\n    if: github.event_name != 'pull_request'\n    run: |\n        curl -s -H \"Authorization: Bearer ${WATCHTOWER_TOKEN}\" \\\n            https://watchtower.thetanerd.com/v1/update\n    env:\n        WATCHTOWER_TOKEN: ${{ secrets.WATCHTOWER_TOKEN }}",
      "text": "- name: Update the blog container\n    if: github.event_name != 'pull_request'\n    run: |\n        curl -s -H \"Authorization: Bearer ${WATCHTOWER_TOKEN}\" \\\n            https://watchtower.thetanerd.com/v1/update\n    env:\n        WATCHTOWER_TOKEN: ${{ secrets.WATCHTOWER_TOKEN }}",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/77",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "You can enable this in watchtower with a few new environment variables in your ",
      "text": "You can enable this in watchtower with a few new environment variables in your "
    },
    {
      "self_ref": "#/texts/78",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "docker-compose.yml",
      "text": "docker-compose.yml",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/79",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": ":",
      "text": ":"
    },
    {
      "self_ref": "#/texts/80",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "watchtower:\n    # New environment variables \ud83d\udc47\n    environment:\n      - WATCHTOWER_HTTP_API_UPDATE=true\n      - WATCHTOWER_HTTP_API_TOKEN=SUPER-SECRET-TOKEN-PASSWORD\n      - WATCHTOWER_HTTP_API_PERIODIC_POLLS=true",
      "text": "watchtower:\n    # New environment variables \ud83d\udc47\n    environment:\n      - WATCHTOWER_HTTP_API_UPDATE=true\n      - WATCHTOWER_HTTP_API_TOKEN=SUPER-SECRET-TOKEN-PASSWORD\n      - WATCHTOWER_HTTP_API_PERIODIC_POLLS=true",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/81",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "WATCHTOWER_HTTP_API_UPDATE",
      "text": "WATCHTOWER_HTTP_API_UPDATE",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/82",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " enables the updating via API and ",
      "text": " enables the updating via API and "
    },
    {
      "self_ref": "#/texts/83",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "WATCHTOWER_HTTP_API_TOKEN",
      "text": "WATCHTOWER_HTTP_API_TOKEN",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/84",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " sets the token required when making the API request. If you set ",
      "text": " sets the token required when making the API request. If you set "
    },
    {
      "self_ref": "#/texts/85",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "WATCHTOWER_HTTP_API_PERIODIC_POLLS",
      "text": "WATCHTOWER_HTTP_API_PERIODIC_POLLS",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/86",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": " to ",
      "text": " to "
    },
    {
      "self_ref": "#/texts/87",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "code",
      "prov": [],
      "orig": "true",
      "text": "true",
      "captions": [],
      "references": [],
      "footnotes": [],
      "code_language": "unknown"
    },
    {
      "self_ref": "#/texts/88",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": ", watchtower will still periodically look for updates to containers even if an API request never appeared. By default, watchtower will stop doing periodic updates if you enable the API.",
      "text": ", watchtower will still periodically look for updates to containers even if an API request never appeared. By default, watchtower will stop doing periodic updates if you enable the API."
    },
    {
      "self_ref": "#/texts/89",
      "parent": {
        "$ref": "#/body"
      },
      "children": [],
      "content_layer": "body",
      "label": "paragraph",
      "prov": [],
      "orig": "This is working on my site right now and you can view my public blog stats on  stats.major.io . \ud83c\udf89",
      "text": "This is working on my site right now and you can view my public blog stats on  stats.major.io . \ud83c\udf89"
    }
  ],
  "pictures": [],
  "tables": [],
  "key_value_items": [],
  "form_items": [],
  "pages": {}
}